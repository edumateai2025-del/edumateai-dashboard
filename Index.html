<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EduMateAI Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family:'Roboto', sans-serif;}
  body { background:#f4f7f9; color:#333; }
  header { background:#1e3c72; color:#fff; padding:15px 20px; text-align:center; }
  header h1 { font-size:1.5rem; }

  .container { max-width:1200px; margin:20px auto; padding:0 20px; }

  /* Cards Section */
  .cards { display:flex; gap:20px; flex-wrap:wrap; margin-bottom:40px; }
  .card {
    background:#fff; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.1);
    flex:1 1 300px; padding:20px; text-align:center;
    transition:transform 0.3s ease;
    cursor:pointer;
  }
  .card:hover { transform:scale(1.03); }
  .card img { width:100%; height:180px; object-fit:cover; border-radius:10px; margin-bottom:15px; }
  .card h2 { margin-bottom:10px; font-size:1.3rem; }
  .card p { margin-bottom:15px; font-size:0.95rem; color:#555; }

  /* News Section */
  .news-section { margin-bottom:40px; }
  .news-section h2 { margin-bottom:15px; font-size:1.4rem; }
  .news-list { display:flex; flex-direction:column; gap:15px; }
  .news-item {
    display:flex; align-items:center; background:#fff; padding:10px 15px; border-radius:10px;
    box-shadow:0 2px 10px rgba(0,0,0,0.05);
  }
  .news-item img { width:80px; height:60px; object-fit:cover; border-radius:6px; margin-right:15px; }
  .news-item h3 { font-size:1rem; }

  /* Loader Overlay */
  #loaderOverlay {
    position:fixed; top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,0.6); display:flex; justify-content:center; align-items:center;
    flex-direction:column; display:none; z-index:999;
  }
  #loaderCanvas { background:transparent; }
  #loaderMessage { margin-top:20px; color:red; font-weight:700; text-align:center; }
</style>
</head>
<body>

<header>
  <h1>EduMateAI Dashboard</h1>
</header>

<div class="container">
  <!-- Cards Section -->
  <div class="cards">
    <div class="card" onclick="openApp('smartTutor')">
      <img src="https://i.postimg.cc/qq5CRVDM/file-00000000197871f494a6abf3eb579e17.png" alt="Smart Tutor">
      <h2>Smart Tutor</h2>
      <p>Interactive lessons and learning modules to boost your skills.</p>
    </div>
    <div class="card" onclick="openApp('quizGenerator')">
      <img src="https://i.ibb.co/1tDvHSsX/file-000000006c6871f4a2d165b66d383516.png" alt="Quiz Generator">
      <h2>Quiz Generator</h2>
      <p>Generate and take quizzes to test your knowledge anytime.</p>
    </div>
  </div>

  <!-- News Section -->
  <div class="news-section">
    <h2>Latest News</h2>
    <div class="news-list"></div>
  </div>
</div>

<!-- Loader Overlay -->
<div id="loaderOverlay">
  <canvas id="loaderCanvas" width="250" height="200"></canvas>
  <p id="loaderMessage"></p>
</div>

<script>
// ================= Chemical Bond Loader =================
const canvas = document.getElementById('loaderCanvas');
const ctx = canvas.getContext('2d');
const width = canvas.width;
const height = canvas.height;

let red = { x: 70, y: height/2, vx: 2, color:'red' };
let blue = { x: 180, y: height/2, vx: -2, color:'blue' };
const radius = 15;

function drawBall(ball) {
  ctx.beginPath();
  ctx.arc(ball.x, ball.y, radius, 0, Math.PI*2);
  ctx.shadowColor = ball.color;
  ctx.shadowBlur = 20;
  ctx.fillStyle = ball.color;
  ctx.fill();
  ctx.shadowBlur = 0;
  ctx.closePath();
}

function draw() {
  ctx.clearRect(0,0,width,height);
  let dx = red.x - blue.x;
  if(Math.abs(dx) < 5) { // very close collision
    ctx.beginPath();
    ctx.arc((red.x + blue.x)/2, height/2, radius+5, 0, Math.PI*2);
    ctx.shadowColor = 'purple';
    ctx.shadowBlur = 25;
    ctx.fillStyle = 'purple';
    ctx.fill();
    ctx.shadowBlur = 0;
    ctx.closePath();
  } else {
    drawBall(red);
    drawBall(blue);
  }
  red.x += red.vx;
  blue.x += blue.vx;
  if(red.x + radius > width || red.x - radius < 0) red.vx *= -1;
  if(blue.x + radius > width || blue.x - radius < 0) blue.vx *= -1;
  requestAnimationFrame(draw);
}

draw();

function showLoader() {
  document.getElementById('loaderOverlay').style.display = 'flex';
  setTimeout(() => {
    document.getElementById('loaderMessage').textContent =
      "⚠️ Your internet connection seems weak. Please check your connection.";
  }, 15000);
}

function hideLoader() {
  document.getElementById('loaderOverlay').style.display = 'none';
  document.getElementById('loaderMessage').textContent = '';
}

// ================= Open Smart Tutor / Quiz =================
function openApp(app) {
  showLoader();
  setTimeout(() => {
    hideLoader();
    if(app === 'smartTutor') {
      window.open('https://edumateai-smarttutor01.vercel.app/', '_blank');
    } else if(app === 'quizGenerator') {
      window.open('https://quiz-generator-pink.vercel.app/', '_blank');
    }
  }, 2000); // simulate brief loading
}

// ================= Load News via API =================
async function loadNews() {
  try {
    const res = await fetch('/api/getNews');
    const articles = await res.json();
    const newsList = document.querySelector('.news-list');
    newsList.innerHTML = '';
    articles.forEach(article => {
      const div = document.createElement('div');
      div.classList.add('news-item');
      div.innerHTML = `
        <img src="${article.urlToImage || 'fallback-image.png'}" alt="${article.title}">
        <h3>${article.title}</h3>
      `;
      newsList.appendChild(div);
    });
  } catch(err) {
    console.error(err);
  }
}

loadNews();
</script>

</body>
      </html>
